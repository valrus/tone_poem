#:kivy 1.1.0

<CreatureWidget>:
    happy_label: happiness

    Image:
        id: sprite
        source: root.image_source
        size_hint: None, None

        Label:
            id: happiness
            font_name: 'fonts/DejaVuSans.ttf'
            text: 'Some text'
            halign: 'left'
            valign: 'bottom'
            pos: self.parent.pos
            text_size: self.parent.size


<EncounterScreen>:
    BoxLayout:
        id: battle_root
        orientation: 'vertical'
        size_hint: 1.0, 1.0
        padding: 10
        spacing: 10

        BoxLayout:
            id: battle_area
            size_hint: 1.0, 0.6

            BoxLayout:
                id: beastie_area
                orientation: 'vertical'
                size_hint: 0.7, 1.0

            BoxLayout:
                id: player_area
                orientation: 'vertical'
                size_hint: 0.3, 1.0

        AnchorLayout:
            id: keyboard_area
            size_hint: 1.0, 0.1

            MidiKeyboard:
                id: kb
                size_hint: 1.0, 1.0

        BoxLayout:
            id: info_area
            size_hint: 1.0, 0.3


<MidiScreen>:
    BoxLayout:
        id: midi_root
        orientation: 'vertical'
        size_hint: 1.0, 1.0
        padding: 10
        spacing: 10

        AnchorLayout:
            id: midi_list_layout

        AnchorLayout:
            id: keyboard_area

            MidiKeyboard:
                id: kb
                size_hint: 0.9, 0.9


#:set white_key_w 1.0 / 7.0
<WhiteKey>:
    size_hint: (white_key_w, 1)
    canvas:
        Color:
            rgb: (0.7, 1, 0.7) if self.pressed else (0.8, 0.8, 0.8)

        Rectangle:
            pos: self.pos
            size: self.size

        Color:
            rgb: (0.7, 1, 0.7) if self.pressed else self.rgb

        Rectangle:
            pos: self.x + 1, self.y + 1
            size: self.width - 2, self.height - 2


#:set black_key_w 1.0 / 10.0
<BlackKey>:
    size_hint: (black_key_w, 0.6)
    canvas:
        Color:
            rgb: (0.3, 0.5, 0.3) if self.pressed else (0, 0, 0)

        Rectangle:
            pos: self.pos
            size: self.size

        Color:
            rgb: (0.3, 0.5, 0.3) if self.pressed else self.rgb

        Rectangle:
            pos: self.x + 1, self.y + 1
            size: self.width - 2, self.height - 2


<MidiKeyboard>:
    WhiteKey:
        id: C
        index: 0
        pos_hint: {'x': white_key_w * 0}
    WhiteKey:
        id: D
        index: 2
        pos_hint: {'x': white_key_w * 1}
    WhiteKey:
        id: E
        index: 4
        pos_hint: {'x': white_key_w * 2}
    WhiteKey:
        id: F
        index: 5
        pos_hint: {'x': white_key_w * 3}
    WhiteKey:
        id: G
        index: 7
        pos_hint: {'x': white_key_w * 4}
    WhiteKey:
        id: A
        index: 9
        pos_hint: {'x': white_key_w * 5}
    WhiteKey:
        id: B
        index: 11
        pos_hint: {'x': white_key_w * 6}
    BlackKey:
        id: Db
        index: 1
        pos_hint: {'x': (white_key_w * 1) - (black_key_w / 2.0), 'top': 1}
    BlackKey:
        id: Eb
        index: 3
        pos_hint: {'x': (white_key_w * 2) - (black_key_w / 2.0), 'top': 1}
    BlackKey:
        id: Gb
        index: 6
        pos_hint: {'x': (white_key_w * 4) - (black_key_w / 2.0), 'top': 1}
    BlackKey:
        id: Ab
        index: 8
        pos_hint: {'x': (white_key_w * 5) - (black_key_w / 2.0), 'top': 1}
    BlackKey:
        id: Bb
        index: 10
        pos_hint: {'x': (white_key_w * 6) - (black_key_w / 2.0), 'top': 1}
